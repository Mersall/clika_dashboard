<!DOCTYPE html>
<html>
<head>
    <title>Auth Test</title>
    <script>
        function checkAuth() {
            const authToken = localStorage.getItem('sb-mdrgxkflxurntyjtfjan-auth-token');
            const output = document.getElementById('output');
            
            if (authToken) {
                try {
                    const parsed = JSON.parse(authToken);
                    const expiresAt = new Date(parsed.expires_at * 1000);
                    const now = new Date();
                    const isExpired = expiresAt < now;
                    
                    output.innerHTML = `
                        <h3>Auth Token Found</h3>
                        <p>Access Token: ${parsed.access_token ? 'Present' : 'Missing'}</p>
                        <p>Refresh Token: ${parsed.refresh_token ? 'Present' : 'Missing'}</p>
                        <p>Expires At: ${expiresAt.toLocaleString()}</p>
                        <p>Is Expired: ${isExpired ? 'YES' : 'NO'}</p>
                        <p>Time until expiry: ${isExpired ? 'EXPIRED' : Math.round((expiresAt - now) / 1000 / 60) + ' minutes'}</p>
                    `;
                } catch (e) {
                    output.innerHTML = '<p>Error parsing token: ' + e.message + '</p>';
                }
            } else {
                output.innerHTML = '<p>No auth token found in localStorage</p>';
            }
        }
        
        // Check on load and every second
        window.onload = () => {
            checkAuth();
            setInterval(checkAuth, 1000);
        };
    </script>
    <style>
        body { font-family: Arial; padding: 20px; background: #111; color: #fff; }
        #output { background: #222; padding: 20px; border-radius: 8px; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Auth Debug Page</h1>
    <div id="output"></div>
    <button onclick="window.location.href='http://localhost:3000/login'">Go to Login</button>
    <button onclick="window.location.href='http://localhost:3000/'">Go to Dashboard</button>
    <button onclick="localStorage.clear(); checkAuth();">Clear localStorage</button>
</body>
</html>